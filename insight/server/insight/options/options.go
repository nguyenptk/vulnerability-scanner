package options

import (
	"net/http"
	"strconv"
)

// Options ...
type Options struct {
	ID         string
	Offset     int
	Limit      int
	XRequestID string
}

// Parse headers of request
func ParseHeaders(header *http.Header) (*Options, error) {
	id := header.Get("id")
	offset, err := parseString(header.Get("offset"))
	if err != nil {
		return nil, err
	}
	limit, err := parseString(header.Get("limit"))
	if err != nil {
		return nil, err
	}
	xRequestID := header.Get("x-request-id")

	options := &Options{
		ID:         id,
		Offset:     offset,
		Limit:      limit,
		XRequestID: xRequestID,
	}

	return options, nil
}

func parseString(header string) (int, error) {
	if "" == header {
		return 0, nil
	}
	result, err := strconv.Atoi(header)
	if err != nil {
		return 0, err
	}
	return result, nil
}
