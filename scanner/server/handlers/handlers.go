package server

import (
	"encoding/json"
	"net/http"

	"github.com/nguyenptk/vulnerability-scanner/scanner/common/log"
	"github.com/nguyenptk/vulnerability-scanner/scanner/server/scanner/session"
	"github.com/nguyenptk/vulnerability-scanner/scanner/storages/mysql"
)

// Scanner holds the singleton object for handlers
type Scanner struct {
	MySQL  *mysql.Database
	Logger *log.Logger
}

// Write response body to client
func (f *Scanner) writeRespBody(w http.ResponseWriter, sess *session.Session, v interface{}) {
	resp := make(map[string]interface{})
	resp["message"] = v
	result, err := json.Marshal(resp)
	if err != nil {
		sess.Out.Error("[%s] Error happened in JSON marshal. Err: %s", sess.Options.XRequestID, err)
	}
	w.Write(result)
}
