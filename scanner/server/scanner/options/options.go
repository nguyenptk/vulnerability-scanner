package options

import (
	"net/http"
	"strings"
)

// Options ...
type Options struct {
	Repos   *string `json:"repos"`
	Target  *string `json:"target"`
	Token   *string `json:"token"`
	Threads *int    `json:"threads"`
}

// ParseScanTargets splits string of targets by comma
func (o Options) ParseScanTargets() []string {
	targets := strings.Split(*o.Target, ",")
	for i, t := range targets {
		targets[i] = strings.Trim(t, " ")
	}
	return targets
}

// Parse parses cmd params
func Parse(req *http.Request) (Options, error) {
	repos := req.Header.Get("repos")
	target := req.Header.Get("target")
	token := req.Header.Get("token")

	options := Options{
		Repos:  &repos,
		Target: &target,
		Token:  &token,
	}

	return options, nil
}
