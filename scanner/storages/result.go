package storages

import (
	"github.com/nguyenptk/vulnerability-scanner/scanner/server/scanner/session"
	"github.com/nguyenptk/vulnerability-scanner/scanner/server/scanner/stats"
	"github.com/nguyenptk/vulnerability-scanner/scanner/server/scanner/vulnerabilities"
)

// Result for the storage
type Result struct {
	XRequestID      string                           `json:"x_request_id,omitempty"`
	Stats           *stats.Stats                     `json:"stats,omitempty"`
	Vulnerabilities []*vulnerabilities.Vulnerability `json:"vulnerabilities,omitempty"`
}

func ConvertToResult(sess *session.Session) *Result {
	return &Result{
		XRequestID:      sess.Options.XRequestID,
		Stats:           sess.Stats,
		Vulnerabilities: sess.Vulnerabilities,
	}
}
